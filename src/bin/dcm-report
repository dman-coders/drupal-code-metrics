#!/usr/bin/env php
<?php
// I don't know where I will be called from -
// this script may be placed in the 'vendor/bin' directory when distributed.
// or it's in the src/bin or root of the project during development or
// stand-alone use.

$loaded = false;

foreach (array(__DIR__ . '/../../autoload.php', __DIR__ . '/../../vendor/autoload.php') as $file) {
  if (file_exists($file)) {
    require $file;
    $loaded = true;
    break;
  }
}

if (!$loaded) {
  die(
    'You need to set up the project dependencies using the following commands:' . PHP_EOL .
    'wget http://getcomposer.org/composer.phar' . PHP_EOL .
    'php composer.phar install' . PHP_EOL
  );
}


$loaded = false;

foreach (array(__DIR__ . '/../../bootstrap.php', __DIR__ . '/../../../bootstrap.php') as $file) {
  if (file_exists($file)) {
    require $file;
    $loaded = true;
    break;
  }
}

if (!isset($conn)) {
  $options = array('database' => $conn);
}
else {
  print(
    'Cannot find bootstrap.php. This is expected to contain a database connectino string, and is required if you want to be sure of using the same database each time' . PHP_EOL;
  );
  $options['database'] = array(
    'driver' => 'pdo_sqlite',
    'path' => __DIR__ . '/../../db.sqlite',
  );
}


$application = new DrupalCodeMetrics\Application('DrupalCodeMetrics console', '0.0-alpha');
$application->run();

